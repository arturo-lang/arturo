import {unitt}!
import relative {../../commons/functions}!

suite "unique" [

    test "removes duplicates inside values" [
        assert -> [1 2 4 3] = unique [1 2 4 1 3 2]
        assert -> "helo wrd" = unique "hellllo wooooorrrrld"
    ]

    test "removes duplicates in-place" [
        blk: [1 2 4 1 3 2]
        str: "hellllo wooooorrrrld"

        unique 'blk
        unique 'str

        assert -> [1 2 4 3] = blk
        assert -> "helo wrd" = str
    ]

    test "removes nested duplicates in-place" [
        example: #[value: [1 2 2 [3 3 4 4] 1 2 [3 4]]]
        expected:  #[value: [1 2 [3 3 4 4] [3 4]] ]

        unique 'example\value
        assert -> equal? expected example
    ]

]

suite "unique.id" [

    test "unique.id keeps a prefix" [
        a: (unique.id "art-")
        assert -> prefix? a "art-"
        assert -> 4 < size a
    ]

]
